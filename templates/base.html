<!doctype html>
<html lang="zh">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="robots" content="index, follow" />
        {% block seo %}{% endblock %}

        <title>
            {% if section.title %}{{ section.title }} - {% endif %} {% if
            page.title %}{{ page.title }} - {% endif %} {{ config.title }}
        </title>

        <link rel="stylesheet" href="/css/zed.css" />

        {% block extra_head %}{% endblock %}
    </head>
    <body>
        <!-- Sidebar - use sidebar.html template -->
        {% include "sidebar.html" %}

        <!-- Main Content -->
        <main class="main-content">
            <div class="background-decoration"></div>

            <div class="content-wrapper">
                {% block content %}{% endblock %}

                <!-- Footer -->
                <footer class="site-footer">
                    <p>Â© 2025 {{ config.title }}. All poems are archived.</p>
                </footer>
            </div>
        </main>

        <!-- Scroll Progress indicator -->
        <div class="manuscript-scroll">
            <div class="manuscript-scroll-bar" id="scroll-progress"></div>
        </div>

        <!-- Scripts -->
        <script>
            // Scroll progress indicator
            function updateScrollProgress() {
                const scrollTop =
                    window.scrollY || document.documentElement.scrollTop;
                const scrollHeight =
                    document.documentElement.scrollHeight -
                    document.documentElement.clientHeight;
                const progress = (scrollTop / scrollHeight) * 100;
                document.getElementById("scroll-progress").style.width =
                    progress + "%";
            }

            window.addEventListener("scroll", updateScrollProgress);
            window.addEventListener("resize", updateScrollProgress);
            updateScrollProgress();

            // Simple search functionality
            const searchInput = document.getElementById("search-input");
            if (searchInput) {
                searchInput.addEventListener(
                    "input",
                    debounce(function (e) {
                        const query = e.target.value.toLowerCase();
                        if (query.length < 1) {
                            // Clear search results
                            return;
                        }

                        // In a real implementation, you would filter content here
                        // For now, we'll just highlight that search is available
                        console.log("Searching for:", query);
                    }, 300),
                );
            }

            // Debounce function for search
            function debounce(func, wait) {
                let timeout;
                return function () {
                    const context = this,
                        args = arguments;
                    clearTimeout(timeout);
                    timeout = setTimeout(() => func.apply(context, args), wait);
                };
            }

            // Smooth scroll for internal links
            document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
                anchor.addEventListener("click", function (e) {
                    e.preventDefault();
                    const target = document.querySelector(
                        this.getAttribute("href"),
                    );
                    if (target) {
                        target.scrollIntoView({
                            behavior: "smooth",
                            block: "start",
                        });
                    }
                });
            });
        </script>

        {% block extra_js %}{% endblock %}
    </body>
</html>
