name: Simple Deploy

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    # ç®€åŒ–æ­¥éª¤ï¼Œåªä½¿ç”¨åŸºæœ¬å·¥å…·
    steps:
      - uses: actions/checkout@v3

      - name: ğŸ’¡ è®¾ç½® Node.js (ç”¨äºå¯èƒ½çš„ JS ä¾èµ–)
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      - name: ğŸ“¦ å®‰è£… Zola (ä» GitHub Releases)
        run: |
          set -e
          curl -sSL https://github.com/getzola/zola/releases/download/v0.22.1/zola-v0.22.1-x86_64-unknown-linux-gnu.tar.gz | tar xzf -
          sudo install zola /usr/local/bin
          zola --version

      - name: ğŸ” å¿«é€Ÿæ„å»ºæµ‹è¯•
        run: |
          echo "=== æ„å»ºä¸­... ==="
          zola build
          echo "=== æ„å»ºå®Œæˆ ==="
          find ./public -name "*.html" | wc -l | xargs echo "ç”Ÿæˆçš„ HTML é¡µé¢æ•°:"

      - name: ğŸš€ éƒ¨ç½²åˆ° Cloudflare Pages
        if: github.ref == 'refs/heads/main'
        uses: cloudflare/pages-action@v1
        with:
          apiToken: ${{ secrets.CF_API_TOKEN }}
          accountId: ${{ secrets.CF_ACCOUNT_ID }}
          projectName: ${{ secrets.CF_PROJECT_NAME }}
          directory: ./public
          branch: main
```

**è¯´æ˜ï¼š**
- è¿™æ˜¯ä¸€ä¸ªæç®€ç‰ˆçš„ CI é…ç½®
- åªå®‰è£…å¿…è¦çš„ Zolaï¼ˆå…¶ä»–å·¥å…·å¦‚ gh-statsã€tinysearchã€cavif éƒ½è·³è¿‡ï¼‰
- ç§»é™¤äº† `make build` ä¾èµ–çš„å¤æ‚å·¥å…·é“¾
- ä½¿ç”¨ GitHub Secrets é…ç½®æ‰€æœ‰å‚æ•°
- æå¤§å‡å°‘äº†æ„å»ºæ—¶é—´å’Œå¤±è´¥å¯èƒ½æ€§
